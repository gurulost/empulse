import{a as d,o,b as e,d as p,F as L,h as D,t as r,n as m,e as v,x as T,r as y,c as P,m as V,p as E,w as U,u as R,s as j,i as w}from"./app-BeGgamdR.js";import{_ as S}from"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"card border-0 shadow-sm rounded-4 overflow-hidden fade-in"},K={class:"table-responsive"},G={class:"table table-hover align-middle mb-0"},H={class:"ps-4 py-3"},J={class:"fw-bold text-dark"},W={class:"small text-muted"},X={class:"py-3"},Y={class:"text-dark"},Z={class:"small text-muted"},ee={class:"py-3"},te={class:"pe-4 py-3 text-end"},se=["onClick"],ae={key:0},ne={key:0,class:"card-footer bg-white border-top d-flex justify-content-between align-items-center py-3 px-4"},le=["disabled"],ie={class:"small text-muted"},oe=["disabled"],re={__name:"CompanyList",props:{companies:{type:Object,required:!0}},emits:["view-company","page-change"],setup(s){return(b,i)=>(o(),d("div",z,[e("div",K,[e("table",G,[i[4]||(i[4]=e("thead",{class:"bg-light"},[e("tr",null,[e("th",{class:"ps-4 py-3 text-secondary text-uppercase small fw-bold"},"Company"),e("th",{class:"py-3 text-secondary text-uppercase small fw-bold"},"Manager"),e("th",{class:"py-3 text-secondary text-uppercase small fw-bold"},"Plan"),e("th",{class:"pe-4 py-3 text-secondary text-uppercase small fw-bold text-end"},"Actions")])],-1)),e("tbody",null,[(o(!0),d(L,null,D(s.companies.data,n=>(o(),d("tr",{key:n.id},[e("td",H,[e("div",J,r(n.title),1),e("div",W,"ID: "+r(n.id),1)]),e("td",X,[e("div",Y,r(n.manager),1),e("div",Z,r(n.manager_email),1)]),e("td",ee,[e("span",{class:m(["badge rounded-pill px-3 py-2",n.tariff===1?"bg-success-subtle text-success":"bg-secondary-subtle text-secondary"])},r(n.tariff===1?"Premium":"Free"),3)]),e("td",te,[e("button",{class:"btn btn-sm btn-light text-primary fw-medium",onClick:a=>b.$emit("view-company",n)},[...i[2]||(i[2]=[v(" View Users ",-1),e("i",{class:"bi bi-arrow-right ms-1"},null,-1)])],8,se)])]))),128)),s.companies.data.length===0?(o(),d("tr",ae,[...i[3]||(i[3]=[e("td",{colspan:"4",class:"text-center text-muted py-5"},[e("i",{class:"bi bi-building-slash fs-1 d-block mb-2"}),v(" No companies found. ")],-1)])])):p("",!0)])])]),s.companies.last_page>1?(o(),d("div",ne,[e("button",{class:"btn btn-sm btn-outline-secondary rounded-pill px-3",disabled:s.companies.current_page===1,onClick:i[0]||(i[0]=n=>b.$emit("page-change",s.companies.current_page-1))},"Previous",8,le),e("span",ie,"Page "+r(s.companies.current_page)+" of "+r(s.companies.last_page),1),e("button",{class:"btn btn-sm btn-outline-secondary rounded-pill px-3",disabled:s.companies.current_page===s.companies.last_page,onClick:i[1]||(i[1]=n=>b.$emit("page-change",s.companies.current_page+1))},"Next",8,oe)])):p("",!0)]))}},de=S(re,[["__scopeId","data-v-ebfd42ab"]]),ce={class:"card border-0 shadow-sm rounded-4 overflow-hidden fade-in"},ue={class:"card-header bg-white border-bottom py-3 px-4 d-flex justify-content-between align-items-center"},pe={class:"input-group",style:{"max-width":"300px"}},be=["value"],me={key:0,class:"badge bg-info-subtle text-info border border-info-subtle d-flex align-items-center gap-2 px-3 py-2 rounded-pill"},ge={class:"table-responsive"},ve={class:"table table-hover align-middle mb-0"},ye={class:"ps-4 py-3"},he={class:"d-flex align-items-center gap-3"},fe={class:"avatar-sm bg-primary-subtle text-primary rounded-circle d-flex align-items-center justify-content-center fw-bold",style:{width:"32px",height:"32px"}},xe={class:"fw-bold text-dark"},_e={class:"small text-muted"},$e={class:"py-3"},we={class:"py-3 text-muted"},ke={class:"pe-4 py-3 text-end"},Ce={class:"btn-group"},Se=["onClick"],Fe=["onClick"],Ue={key:0},je={key:0,class:"card-footer bg-white border-top d-flex justify-content-between align-items-center py-3 px-4"},Le=["disabled"],De={class:"small text-muted"},Pe=["disabled"],Ae={__name:"UserList",props:{users:{type:Object,required:!0},searchQuery:String,companyFilter:[String,Number]},emits:["update:searchQuery","search","clear-filter","page-change","impersonate","delete"],setup(s){const b=n=>({0:"Super Admin",1:"Manager",3:"Team Lead",4:"Employee"})[n]??"Unknown",i=n=>({0:"bg-danger-subtle text-danger",1:"bg-primary-subtle text-primary",3:"bg-info-subtle text-info",4:"bg-secondary-subtle text-secondary"})[n]??"bg-light text-dark";return(n,a)=>(o(),d("div",ce,[e("div",ue,[e("div",pe,[a[5]||(a[5]=e("span",{class:"input-group-text bg-light border-end-0"},[e("i",{class:"bi bi-search text-muted"})],-1)),e("input",{type:"text",class:"form-control bg-light border-start-0 ps-0",placeholder:"Search users...",value:s.searchQuery,onInput:a[0]||(a[0]=l=>n.$emit("update:searchQuery",l.target.value)),onKeyup:a[1]||(a[1]=T(l=>n.$emit("search"),["enter"]))},null,40,be)]),s.companyFilter?(o(),d("div",me,[v(" Company ID: "+r(s.companyFilter)+" ",1),e("button",{type:"button",class:"btn-close btn-close-dark",style:{"font-size":"0.5em"},"aria-label":"Close",onClick:a[2]||(a[2]=l=>n.$emit("clear-filter"))})])):p("",!0)]),e("div",ge,[e("table",ve,[a[9]||(a[9]=e("thead",{class:"bg-light"},[e("tr",null,[e("th",{class:"ps-4 py-3 text-secondary text-uppercase small fw-bold"},"User"),e("th",{class:"py-3 text-secondary text-uppercase small fw-bold"},"Role"),e("th",{class:"py-3 text-secondary text-uppercase small fw-bold"},"Company ID"),e("th",{class:"pe-4 py-3 text-secondary text-uppercase small fw-bold text-end"},"Actions")])],-1)),e("tbody",null,[(o(!0),d(L,null,D(s.users.data,l=>(o(),d("tr",{key:l.id},[e("td",ye,[e("div",he,[e("div",fe,r(l.name.charAt(0).toUpperCase()),1),e("div",null,[e("div",xe,r(l.name),1),e("div",_e,r(l.email),1)])])]),e("td",$e,[e("span",{class:m(["badge rounded-pill px-3 py-2",i(l.role)])},r(b(l.role)),3)]),e("td",we,r(l.company_id),1),e("td",ke,[e("div",Ce,[e("button",{class:"btn btn-sm btn-outline-primary rounded-start-pill",onClick:g=>n.$emit("impersonate",l.id),title:"Login as this user"},[...a[6]||(a[6]=[e("i",{class:"bi bi-box-arrow-in-right"},null,-1),v(" Login ",-1)])],8,Se),e("button",{class:"btn btn-sm btn-outline-danger rounded-end-pill",onClick:g=>n.$emit("delete",l.id),title:"Delete User"},[...a[7]||(a[7]=[e("i",{class:"bi bi-trash"},null,-1)])],8,Fe)])])]))),128)),s.users.data.length===0?(o(),d("tr",Ue,[...a[8]||(a[8]=[e("td",{colspan:"4",class:"text-center text-muted py-5"},[e("i",{class:"bi bi-person-x fs-1 d-block mb-2"}),v(" No users found. ")],-1)])])):p("",!0)])])]),s.users.last_page>1?(o(),d("div",je,[e("button",{class:"btn btn-sm btn-outline-secondary rounded-pill px-3",disabled:s.users.current_page===1,onClick:a[3]||(a[3]=l=>n.$emit("page-change",s.users.current_page-1))},"Previous",8,Le),e("span",De,"Page "+r(s.users.current_page)+" of "+r(s.users.last_page),1),e("button",{class:"btn btn-sm btn-outline-secondary rounded-pill px-3",disabled:s.users.current_page===s.users.last_page,onClick:a[4]||(a[4]=l=>n.$emit("page-change",s.users.current_page+1))},"Next",8,Pe)])):p("",!0)]))}},Ie=S(Ae,[["__scopeId","data-v-4dc304c4"]]),Ne={class:"card border-0 shadow-sm rounded-4 overflow-hidden fade-in"},Qe={class:"table-responsive"},Me={class:"table table-hover align-middle mb-0"},Be={class:"ps-4 py-3 text-muted"},qe={class:"py-3"},Oe={class:"fw-bold text-dark"},Te={class:"small text-muted"},Ve={class:"py-3"},Ee={class:"badge bg-primary-subtle text-primary rounded-pill px-3"},Re={class:"py-3"},ze={class:"pe-4 py-3 text-end text-muted"},Ke={key:0},Ge={key:0,class:"card-footer bg-white border-top d-flex justify-content-between align-items-center py-3 px-4"},He=["disabled"],Je={class:"small text-muted"},We=["disabled"],Xe={__name:"SubscriptionList",props:{subscriptions:{type:Object,required:!0}},emits:["page-change"],setup(s){const b=n=>n.stripe_status==="active"||n.stripe_status==="trialing",i=n=>n?new Date(n).toLocaleDateString():"Never";return(n,a)=>(o(),d("div",Ne,[e("div",Qe,[e("table",Me,[a[3]||(a[3]=e("thead",{class:"bg-light"},[e("tr",null,[e("th",{class:"ps-4 py-3 text-secondary text-uppercase small fw-bold"},"ID"),e("th",{class:"py-3 text-secondary text-uppercase small fw-bold"},"User"),e("th",{class:"py-3 text-secondary text-uppercase small fw-bold"},"Plan"),e("th",{class:"py-3 text-secondary text-uppercase small fw-bold"},"Status"),e("th",{class:"pe-4 py-3 text-secondary text-uppercase small fw-bold text-end"},"Ends At")])],-1)),e("tbody",null,[(o(!0),d(L,null,D(s.subscriptions.data,l=>(o(),d("tr",{key:l.id},[e("td",Be,"#"+r(l.id),1),e("td",qe,[e("div",Oe,r(l.user_name),1),e("div",Te,r(l.user_email),1)]),e("td",Ve,[e("span",Ee,r(l.name),1)]),e("td",Re,[e("span",{class:m(["badge rounded-pill px-3",b(l)?"bg-success-subtle text-success":"bg-warning-subtle text-warning"])},r(b(l)?"Active":"Inactive"),3)]),e("td",ze,r(i(l.ends_at)),1)]))),128)),s.subscriptions.data.length===0?(o(),d("tr",Ke,[...a[2]||(a[2]=[e("td",{colspan:"5",class:"text-center text-muted py-5"},[e("i",{class:"bi bi-credit-card fs-1 d-block mb-2"}),v(" No subscriptions found. ")],-1)])])):p("",!0)])])]),s.subscriptions.last_page>1?(o(),d("div",Ge,[e("button",{class:"btn btn-sm btn-outline-secondary rounded-pill px-3",disabled:s.subscriptions.current_page===1,onClick:a[0]||(a[0]=l=>n.$emit("page-change",s.subscriptions.current_page-1))},"Previous",8,He),e("span",Je,"Page "+r(s.subscriptions.current_page)+" of "+r(s.subscriptions.last_page),1),e("button",{class:"btn btn-sm btn-outline-secondary rounded-pill px-3",disabled:s.subscriptions.current_page===s.subscriptions.last_page,onClick:a[1]||(a[1]=l=>n.$emit("page-change",s.subscriptions.current_page+1))},"Next",8,We)])):p("",!0)]))}},Ye=S(Xe,[["__scopeId","data-v-a3b407bc"]]),Ze={class:"admin-layout d-flex min-vh-100"},et={key:0,class:"fs-5 fw-bold tracking-tight ms-3"},tt={class:"nav nav-pills flex-column gap-2"},st={class:"nav-item"},at={key:0},nt={class:"nav-item"},lt={key:0},it={class:"nav-item"},ot={key:0},rt={class:"nav-item mt-4"},dt={key:0,class:"text-uppercase small text-white-50 fw-bold px-3 mb-2"},ct={href:"/home",class:"nav-link text-white-50 hover-white"},ut={key:0},pt={class:"flex-grow-1 d-flex flex-column bg-light"},bt={class:"bg-white border-bottom py-3 px-4 d-flex justify-content-between align-items-center sticky-top shadow-sm"},mt={class:"d-flex align-items-center gap-3"},gt={class:"dropdown"},vt={href:"#",class:"d-flex align-items-center gap-2 text-decoration-none dropdown-toggle text-dark","data-bs-toggle":"dropdown"},yt={class:"avatar bg-primary text-white rounded-circle d-flex align-items-center justify-content-center fw-bold"},ht={class:"d-none d-md-block fw-medium"},ft={class:"dropdown-menu dropdown-menu-end border-0 shadow-lg rounded-3 mt-2"},xt={class:"dropdown-header"},_t={action:"/logout",method:"POST"},$t=["value"],wt={class:"p-4"},kt={class:"container-fluid"},Ct={class:"d-flex justify-content-between align-items-center mb-4"},St={class:"h4 fw-bold text-dark mb-0"},Ft={key:0,class:"text-center py-5"},Ut={key:1},jt={__name:"AdminDashboard",props:{user:{type:Object,required:!0}},setup(s){const b=s,i=y("companies"),n=y({data:[],current_page:1,last_page:1}),a=y({data:[],current_page:1,last_page:1}),l=y({data:[],current_page:1,last_page:1}),g=y(!1),k=y(""),_=y(null),u=y(!1),A=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),I=P(()=>!b.user||!b.user.name?"U":b.user.name.split(" ").map(c=>c[0]).join("").toUpperCase().substring(0,2)),N=P(()=>({companies:"Company Management",users:"User Management",subscriptions:"Subscription Management"})[i.value]??"Dashboard"),C=async(c=1)=>{g.value=!0;try{const{data:t}=await w.get(`/admin/api/companies?page=${c}`);n.value=t}catch(t){console.error(t),alert("Failed to load companies")}finally{g.value=!1}},h=async(c=1)=>{g.value=!0;try{const t={page:c,search:k.value};_.value&&(t.company_id=_.value);const{data:f}=await w.get("/admin/api/users",{params:t});a.value=f}catch(t){console.error(t),alert("Failed to load users")}finally{g.value=!1}},F=async(c=1)=>{g.value=!0;try{const{data:t}=await w.get(`/admin/subscription/list?page=${c}`);l.value=t}catch(t){console.error(t),alert("Failed to load subscriptions")}finally{g.value=!1}},Q=async c=>{var t,f;if(confirm("Are you sure you want to delete this user?"))try{await w.delete(`/admin/api/users/${c}`),h(a.value.current_page)}catch($){console.error($),alert(((f=(t=$.response)==null?void 0:t.data)==null?void 0:f.message)||"Failed to delete user")}},M=async c=>{if(confirm("Login as this user?"))try{const{data:t}=await w.post(`/admin/api/users/${c}/impersonate`);window.location.href=t.redirect}catch(t){console.error(t),alert("Failed to impersonate user")}},B=c=>{_.value=c.id,k.value="",i.value="users",h(1)},q=()=>{_.value=null,h(1)},O=()=>{i.value==="companies"?C(n.value.current_page):i.value==="users"?h(a.value.current_page):i.value==="subscriptions"&&F(l.value.current_page)};return V(i,c=>{c==="companies"&&n.value.data.length===0&&C(),c==="users"&&a.value.data.length===0&&h(),c==="subscriptions"&&l.value.data.length===0&&F()}),E(()=>{C()}),(c,t)=>{var f,$;return o(),d("div",Ze,[e("aside",{class:m(["sidebar d-flex flex-column flex-shrink-0 p-4 text-white",{collapsed:u.value}])},[e("div",{class:m(["d-flex align-items-center mb-4 px-2",{"justify-content-center":u.value}])},[t[6]||(t[6]=e("div",{class:"logo-container glass d-flex align-items-center justify-content-center rounded-3",style:{width:"40px",height:"40px"}},[e("i",{class:"bi bi-graph-up-arrow text-white fs-5"})],-1)),u.value?p("",!0):(o(),d("span",et,"Empulse"))],2),t[7]||(t[7]=e("div",{class:"nav-spacer mb-4"},null,-1)),e("nav",null,[e("ul",tt,[e("li",st,[e("a",{href:"#",class:m(["nav-link",{active:i.value==="companies"}]),onClick:t[0]||(t[0]=U(x=>i.value="companies",["prevent"]))},[e("i",{class:m(["bi bi-building fs-5",{"me-3":!u.value}])},null,2),u.value?p("",!0):(o(),d("span",at,"Companies"))],2)]),e("li",nt,[e("a",{href:"#",class:m(["nav-link",{active:i.value==="users"}]),onClick:t[1]||(t[1]=U(x=>i.value="users",["prevent"]))},[e("i",{class:m(["bi bi-people fs-5",{"me-3":!u.value}])},null,2),u.value?p("",!0):(o(),d("span",lt,"Users"))],2)]),e("li",it,[e("a",{href:"#",class:m(["nav-link",{active:i.value==="subscriptions"}]),onClick:t[2]||(t[2]=U(x=>i.value="subscriptions",["prevent"]))},[e("i",{class:m(["bi bi-credit-card fs-5",{"me-3":!u.value}])},null,2),u.value?p("",!0):(o(),d("span",ot,"Subscriptions"))],2)]),e("li",rt,[u.value?p("",!0):(o(),d("div",dt,"System")),e("a",ct,[e("i",{class:m(["bi bi-box-arrow-left fs-5",{"me-3":!u.value}])},null,2),u.value?p("",!0):(o(),d("span",ut,"Back to App"))])])])])],2),e("div",pt,[e("header",bt,[e("button",{class:"btn btn-link text-secondary p-0",onClick:t[3]||(t[3]=x=>u.value=!u.value)},[...t[8]||(t[8]=[e("i",{class:"bi bi-list fs-4"},null,-1)])]),e("div",mt,[e("div",gt,[e("a",vt,[e("div",yt,r(I.value),1),e("span",ht,r((f=s.user)==null?void 0:f.name),1)]),e("ul",ft,[e("li",null,[e("h6",xt,[t[9]||(t[9]=v("Signed in as ",-1)),t[10]||(t[10]=e("br",null,null,-1)),e("strong",null,r(($=s.user)==null?void 0:$.email),1)])]),t[12]||(t[12]=e("li",null,[e("hr",{class:"dropdown-divider"})],-1)),e("li",null,[e("form",_t,[e("input",{type:"hidden",name:"_token",value:R(A)},null,8,$t),t[11]||(t[11]=e("button",{type:"submit",class:"dropdown-item text-danger d-flex align-items-center gap-2"},[e("i",{class:"bi bi-box-arrow-right"}),v(" Logout ")],-1))])])])])])]),e("main",wt,[e("div",kt,[e("div",Ct,[e("h2",St,r(N.value),1),e("div",null,[e("button",{class:"btn btn-primary d-flex align-items-center gap-2 rounded-pill shadow-sm",onClick:O},[...t[13]||(t[13]=[e("i",{class:"bi bi-arrow-clockwise"},null,-1),v(" Refresh ",-1)])])])]),g.value?(o(),d("div",Ft,[...t[14]||(t[14]=[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1)])])):(o(),d("div",Ut,[i.value==="companies"?(o(),j(de,{key:0,companies:n.value,onViewCompany:B,onPageChange:C},null,8,["companies"])):i.value==="users"?(o(),j(Ie,{key:1,users:a.value,searchQuery:k.value,"onUpdate:searchQuery":t[4]||(t[4]=x=>k.value=x),companyFilter:_.value,onSearch:t[5]||(t[5]=x=>h(1)),onClearFilter:q,onPageChange:h,onImpersonate:M,onDelete:Q},null,8,["users","searchQuery","companyFilter"])):i.value==="subscriptions"?(o(),j(Ye,{key:2,subscriptions:l.value,onPageChange:F},null,8,["subscriptions"])):p("",!0)]))])])])])}}},Pt=S(jt,[["__scopeId","data-v-e3d2985b"]]);export{Pt as default};
