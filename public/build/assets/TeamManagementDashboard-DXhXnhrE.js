import{i as N,c as q,r as f,m as W,s as z,o as n,b as e,t as A,w as B,a as i,d as x,q as D,e as M,y as G,n as V,K as P,v as X,F as j,h as H,L as Y,p as Z,f as K,x as ae,g as ce,A as pe}from"./app-BeGgamdR.js";import{u as ee}from"./useToast-3pCS-Upl.js";import{S as O}from"./SkeletonLoader-DsZlrgnT.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";function J(){return{getTeamMembers:async(c={})=>{const u=new URLSearchParams(c).toString(),k=u?`/team/api/members?${u}`:"/team/api/members",{data:w}=await N.get(k);return w},addTeamMember:async c=>{const{data:u}=await N.post("/team/api/members",c);return u},updateTeamMember:async(c,u)=>{const{data:k}=await N.put(`/team/api/members/${c}`,u);return k},deleteTeamMember:async c=>{const{data:u}=await N.delete(`/team/api/members/${c}`);return u},importUsers:async c=>{const u=new FormData;u.append("file",c);const{data:k}=await N.post("/team/api/members/import",u,{headers:{"Content-Type":"multipart/form-data"}});return k},exportTemplate:async c=>{window.location.href=`/users/export/${c}`},getDepartments:async()=>{const{data:c}=await N.get("/team/api/departments");return c},addDepartment:async c=>{const{data:u}=await N.post("/team/api/departments",{title:c});return u},updateDepartment:async(c,u)=>{const{data:k}=await N.put(`/team/api/departments/${c}`,{newTitle:u});return k},deleteDepartment:async c=>{const{data:u}=await N.delete(`/team/api/departments/${c}`);return u}}}const ve={class:"modal d-block",tabindex:"-1",style:{background:"rgba(0,0,0,0.5)"}},be={class:"modal-dialog"},ye={class:"modal-content"},fe={class:"modal-header"},ge={class:"modal-title"},he={class:"modal-body"},ke={class:"mb-3"},$e={class:"invalid-feedback"},_e={class:"mb-3"},Me=["disabled"],Te={class:"invalid-feedback"},we={key:0,class:"mb-3"},xe={class:"form-check"},Ce={class:"form-check"},De={class:"form-check"},Re={class:"form-check"},Ue={key:1,class:"mb-3"},Ae={class:"form-check"},Ee={class:"form-check"},Fe={key:2,class:"mb-3"},Ve=["value"],Se={class:"modal-footer"},Ne=["disabled"],Ie={key:0,class:"spinner-border spinner-border-sm me-2"},Le={__name:"AddMemberModal",props:{member:{type:Object,default:null},userRole:{type:Number,required:!0},departments:{type:Array,default:()=>[]}},emits:["close","saved"],setup(g,{emit:I}){var w,S,E,F;const b=g,T=I,C=J(),y=ee(),$=q(()=>!!b.member),a=f({name:((w=b.member)==null?void 0:w.name)||"",email:((S=b.member)==null?void 0:S.email)||"",role:((E=b.member)==null?void 0:E.role)||4,department:((F=b.member)==null?void 0:F.department)||""}),o=f({}),p=f(!1),c=q(()=>b.userRole===1||b.userRole===2),u=q(()=>a.value.name.length>=5&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.value.email)&&a.value.role);W(()=>a.value.name,_=>{_.length>0&&_.length<5?o.value.name="Name must be at least 5 characters":delete o.value.name}),W(()=>a.value.email,_=>{_&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(_)?o.value.email="Please enter a valid email address":delete o.value.email});const k=async()=>{var _,s;if(u.value){p.value=!0;try{const d={name:a.value.name,email:a.value.email,role:a.value.role,department:a.value.department||null};$.value?(await C.updateTeamMember(b.member.email,{new_name:d.name,new_email:d.email,new_role:d.role,new_department:d.department}),y.success("Team member updated successfully")):(await C.addTeamMember(d),y.success("Team member added successfully")),T("saved")}catch(d){const v=((s=(_=d.response)==null?void 0:_.data)==null?void 0:s.message)||"Operation failed";y.error(v)}finally{p.value=!1}}};return(_,s)=>(n(),z(Y,{to:"body"},[e("div",ve,[e("div",be,[e("div",ye,[e("div",fe,[e("h5",ge,A($.value?"Edit":"Add")+" Team Member",1),e("button",{type:"button",class:"btn-close",onClick:s[0]||(s[0]=d=>_.$emit("close"))})]),e("form",{onSubmit:B(k,["prevent"])},[e("div",he,[e("div",ke,[s[11]||(s[11]=e("label",{class:"form-label"},[M("Name "),e("span",{class:"text-danger"},"*")],-1)),D(e("input",{"onUpdate:modelValue":s[1]||(s[1]=d=>a.value.name=d),type:"text",class:V(["form-control",{"is-invalid":o.value.name}]),placeholder:"Min. 5 characters"},null,2),[[G,a.value.name]]),e("div",$e,A(o.value.name),1)]),e("div",_e,[s[12]||(s[12]=e("label",{class:"form-label"},[M("Email "),e("span",{class:"text-danger"},"*")],-1)),D(e("input",{"onUpdate:modelValue":s[2]||(s[2]=d=>a.value.email=d),type:"email",class:V(["form-control",{"is-invalid":o.value.email}]),disabled:$.value,placeholder:"user@example.com"},null,10,Me),[[G,a.value.email]]),e("div",Te,A(o.value.email),1)]),g.userRole===1?(n(),i("div",we,[s[17]||(s[17]=e("label",{class:"form-label"},[M("Role "),e("span",{class:"text-danger"},"*")],-1)),e("div",xe,[D(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":s[3]||(s[3]=d=>a.value.role=d),value:1,id:"roleManager"},null,512),[[P,a.value.role]]),s[13]||(s[13]=e("label",{class:"form-check-label",for:"roleManager"},"Manager",-1))]),e("div",Ce,[D(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":s[4]||(s[4]=d=>a.value.role=d),value:2,id:"roleChief"},null,512),[[P,a.value.role]]),s[14]||(s[14]=e("label",{class:"form-check-label",for:"roleChief"},"Chief",-1))]),e("div",De,[D(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":s[5]||(s[5]=d=>a.value.role=d),value:3,id:"roleTeamleadManager"},null,512),[[P,a.value.role]]),s[15]||(s[15]=e("label",{class:"form-check-label",for:"roleTeamleadManager"},"Teamlead",-1))]),e("div",Re,[D(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":s[6]||(s[6]=d=>a.value.role=d),value:4,id:"roleEmployeeManager"},null,512),[[P,a.value.role]]),s[16]||(s[16]=e("label",{class:"form-check-label",for:"roleEmployeeManager"},"Employee",-1))])])):x("",!0),g.userRole===2?(n(),i("div",Ue,[s[20]||(s[20]=e("label",{class:"form-label"},[M("Role "),e("span",{class:"text-danger"},"*")],-1)),e("div",Ae,[D(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":s[7]||(s[7]=d=>a.value.role=d),value:3,id:"roleTeamlead"},null,512),[[P,a.value.role]]),s[18]||(s[18]=e("label",{class:"form-check-label",for:"roleTeamlead"},"Teamlead",-1))]),e("div",Ee,[D(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":s[8]||(s[8]=d=>a.value.role=d),value:4,id:"roleEmployee",checked:""},null,512),[[P,a.value.role]]),s[19]||(s[19]=e("label",{class:"form-check-label",for:"roleEmployee"},"Employee",-1))])])):x("",!0),c.value?(n(),i("div",Fe,[s[22]||(s[22]=e("label",{class:"form-label"},"Department",-1)),D(e("select",{"onUpdate:modelValue":s[9]||(s[9]=d=>a.value.department=d),class:"form-select"},[s[21]||(s[21]=e("option",{value:""},"None",-1)),(n(!0),i(j,null,H(g.departments,d=>(n(),i("option",{key:d.title,value:d.title},A(d.title),9,Ve))),128))],512),[[X,a.value.department]])])):x("",!0)]),e("div",Se,[e("button",{type:"button",class:"btn btn-secondary",onClick:s[10]||(s[10]=d=>_.$emit("close"))},"Cancel"),e("button",{type:"submit",class:"btn btn-primary",disabled:!u.value||p.value},[p.value?(n(),i("span",Ie)):x("",!0),M(" "+A($.value?"Update":"Add"),1)],8,Ne)])],32)])])])]))}},qe={class:"card shadow-sm"},Be={class:"card-header d-flex justify-content-between align-items-center"},Ke={class:"d-flex gap-2"},Pe={class:"card-body"},je={class:"row g-3 mb-3"},He={class:"col-md-4"},Oe={key:0,class:"col-md-3"},ze=["value"],Ge={key:1,class:"col-md-3"},Je=["value"],Qe={key:0,class:"text-center py-5"},We={key:1,class:"table-responsive"},Xe={class:"table table-hover"},Ye={class:"table-light"},Ze={key:0},et=["innerHTML"],tt=["innerHTML"],st={key:0},at={class:"btn-group btn-group-sm"},lt=["onClick"],nt=["onClick"],ot={key:0,class:"mt-3"},rt={class:"pagination justify-content-center"},it=["onClick"],dt={key:2,class:"text-center py-5 text-muted"},ut={key:0,class:"modal d-block",tabindex:"-1",style:{background:"rgba(0,0,0,0.5)"}},mt={class:"modal-dialog"},ct={class:"modal-content"},pt={class:"modal-header"},vt={class:"modal-body"},bt={class:"text-muted mb-3"},yt=["href"],ft={class:"modal-footer"},gt=["disabled"],ht={__name:"TeamMemberTable",props:{userRole:{type:Number,required:!0},departments:{type:Array,default:()=>[]},canManageDepartments:{type:Boolean,default:!1}},emits:["refresh-departments"],setup(g,{emit:I}){const b=g,T=I,C=J(),y=ee(),$=f(!1),a=f([]),o=f({current_page:1,last_page:1}),p=f({search:"",role:"",department:""}),c=f("name"),u=f("asc"),k=f(!1),w=f(!1),S=f(null),E=f(null);let F=null;const _=q(()=>b.userRole===1||b.userRole===2),s=q(()=>b.userRole===1?[{value:1,label:"Manager"},{value:2,label:"Chief"},{value:3,label:"Teamlead"},{value:4,label:"Employee"}]:b.userRole===2?[{value:3,label:"Teamlead"},{value:4,label:"Employee"}]:[]),d=q(()=>{const m=[],t=o.value.current_page,l=o.value.last_page;for(let L=Math.max(1,t-2);L<=Math.min(l,t+2);L++)m.push(L);return m}),v=async(m=1)=>{$.value=!0;try{const t={page:m,q:p.value.search,role:p.value.role,department:p.value.department,sort:c.value,dir:u.value},l=await C.getTeamMembers(t);a.value=l.data,o.value={current_page:l.current_page,last_page:l.last_page}}catch(t){console.error("Failed to load members:",t),y.error("Failed to load team members")}finally{$.value=!1}},r=()=>{clearTimeout(F),F=setTimeout(()=>{o.value.current_page=1,v(1)},300)},h=()=>{p.value={search:"",role:"",department:""},v(1)},R=m=>{c.value===m?u.value=u.value==="asc"?"desc":"asc":(c.value=m,u.value="asc"),v(o.value.current_page)},U=m=>c.value!==m?"bi bi-chevron-expand text-muted":u.value==="asc"?"bi bi-chevron-up":"bi bi-chevron-down",Q=m=>{m>=1&&m<=o.value.last_page&&(o.value.current_page=m,v(m))},te=m=>{if(!m)return"";const t=m.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");if(!p.value.search)return t;const l=p.value.search.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),L=new RegExp(`(${l})`,"gi");return t.replace(L,"<mark>$1</mark>")},ne=m=>({1:"Manager",2:"Chief",3:"Teamlead",4:"Employee"})[m]||"Unknown",oe=m=>({1:"bg-primary",2:"bg-info",3:"bg-success",4:"bg-secondary"})[m]||"bg-secondary",re=m=>{S.value={...m}},ie=async m=>{if(confirm(`Are you sure you want to delete ${m.name}?`))try{await C.deleteTeamMember(m.email),y.success("Team member deleted successfully"),v(o.value.current_page)}catch{y.error("Failed to delete team member")}},se=()=>{k.value=!1,S.value=null},de=()=>{se(),v(o.value.current_page),T("refresh-departments")},ue=m=>{E.value=m.target.files[0]},me=async()=>{var m,t;if(E.value)try{await C.importUsers(E.value),y.success("Users imported successfully"),w.value=!1,E.value=null,v(1),T("refresh-departments")}catch(l){y.error(((t=(m=l.response)==null?void 0:m.data)==null?void 0:t.message)||"Import failed")}};return Z(()=>{v(1)}),(m,t)=>(n(),i("div",qe,[e("div",Be,[t[13]||(t[13]=e("h5",{class:"mb-0"},"Team Members",-1)),e("div",Ke,[e("button",{class:"btn btn-sm btn-success",onClick:t[0]||(t[0]=l=>w.value=!0)},[...t[11]||(t[11]=[e("i",{class:"bi bi-upload me-1"},null,-1),M("Import ",-1)])]),e("button",{class:"btn btn-sm btn-primary",onClick:t[1]||(t[1]=l=>k.value=!0)},[...t[12]||(t[12]=[e("i",{class:"bi bi-person-plus me-1"},null,-1),M("Add Member ",-1)])])])]),e("div",Pe,[e("div",je,[e("div",He,[D(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>p.value.search=l),type:"text",class:"form-control",placeholder:"Search by name or email...",onInput:r},null,544),[[G,p.value.search]])]),_.value?(n(),i("div",Oe,[D(e("select",{"onUpdate:modelValue":t[3]||(t[3]=l=>p.value.role=l),class:"form-select",onChange:v},[t[14]||(t[14]=e("option",{value:""},"All Roles",-1)),(n(!0),i(j,null,H(s.value,l=>(n(),i("option",{key:l.value,value:l.value},A(l.label),9,ze))),128))],544),[[X,p.value.role]])])):x("",!0),g.userRole===1?(n(),i("div",Ge,[D(e("select",{"onUpdate:modelValue":t[4]||(t[4]=l=>p.value.department=l),class:"form-select",onChange:v},[t[15]||(t[15]=e("option",{value:""},"All Departments",-1)),(n(!0),i(j,null,H(g.departments,l=>(n(),i("option",{key:l.title,value:l.title},A(l.title),9,Je))),128))],544),[[X,p.value.department]])])):x("",!0),e("div",{class:"col-md-2"},[e("button",{class:"btn btn-outline-secondary w-100",onClick:h},[...t[16]||(t[16]=[e("i",{class:"bi bi-x-circle me-1"},null,-1),M("Clear ",-1)])])])]),$.value?(n(),i("div",Qe,[K(O,{height:"3rem",class:"mb-2"}),K(O,{height:"3rem",class:"mb-2"}),K(O,{height:"3rem",class:"mb-2"})])):a.value.length>0?(n(),i("div",We,[e("table",Xe,[e("thead",Ye,[e("tr",null,[e("th",{onClick:t[5]||(t[5]=l=>R("name")),class:"cursor-pointer"},[t[17]||(t[17]=M(" Name ",-1)),e("i",{class:V(U("name"))},null,2)]),e("th",{onClick:t[6]||(t[6]=l=>R("email")),class:"cursor-pointer"},[t[18]||(t[18]=M(" Email ",-1)),e("i",{class:V(U("email"))},null,2)]),t[19]||(t[19]=e("th",null,"Role",-1)),g.userRole===1?(n(),i("th",Ze,"Department")):x("",!0),t[20]||(t[20]=e("th",null,"Actions",-1))])]),e("tbody",null,[(n(!0),i(j,null,H(a.value,l=>(n(),i("tr",{key:l.email},[e("td",null,[e("span",{innerHTML:te(l.name)},null,8,et)]),e("td",null,[e("span",{innerHTML:te(l.email)},null,8,tt)]),e("td",null,[e("span",{class:V(["badge",oe(l.role)])},A(ne(l.role)),3)]),g.userRole===1?(n(),i("td",st,A(l.department||"-"),1)):x("",!0),e("td",null,[e("div",at,[e("button",{class:"btn btn-outline-primary",onClick:L=>re(l),title:"Edit"},[...t[21]||(t[21]=[e("i",{class:"bi bi-pencil"},null,-1)])],8,lt),e("button",{class:"btn btn-outline-danger",onClick:L=>ie(l),title:"Delete"},[...t[22]||(t[22]=[e("i",{class:"bi bi-trash"},null,-1)])],8,nt)])])]))),128))])]),o.value.last_page>1?(n(),i("nav",ot,[e("ul",rt,[e("li",{class:V(["page-item",{disabled:o.value.current_page===1}])},[e("a",{class:"page-link",href:"#",onClick:t[7]||(t[7]=B(l=>Q(o.value.current_page-1),["prevent"]))},"Previous")],2),(n(!0),i(j,null,H(d.value,l=>(n(),i("li",{key:l,class:V(["page-item",{active:l===o.value.current_page}])},[e("a",{class:"page-link",href:"#",onClick:B(L=>Q(l),["prevent"])},A(l),9,it)],2))),128)),e("li",{class:V(["page-item",{disabled:o.value.current_page===o.value.last_page}])},[e("a",{class:"page-link",href:"#",onClick:t[8]||(t[8]=B(l=>Q(o.value.current_page+1),["prevent"]))},"Next")],2)])])):x("",!0)])):(n(),i("div",dt,[...t[23]||(t[23]=[e("i",{class:"bi bi-people display-4 mb-3 d-block"},null,-1),e("p",null,"No team members found",-1)])]))]),k.value||S.value?(n(),z(Le,{key:0,member:S.value,"user-role":g.userRole,departments:g.departments,onClose:se,onSaved:de},null,8,["member","user-role","departments"])):x("",!0),(n(),z(Y,{to:"body"},[w.value?(n(),i("div",ut,[e("div",mt,[e("div",ct,[e("div",pt,[t[24]||(t[24]=e("h5",{class:"modal-title"},"Import Team Members",-1)),e("button",{type:"button",class:"btn-close",onClick:t[9]||(t[9]=l=>w.value=!1)})]),e("div",vt,[e("p",bt,[e("a",{href:`/users/export/${g.userRole}`,class:"btn btn-sm btn-outline-primary"},[...t[25]||(t[25]=[e("i",{class:"bi bi-download me-1"},null,-1),M("Download Template ",-1)])],8,yt)]),e("input",{type:"file",class:"form-control",onChange:ue,accept:".xlsx,.xls"},null,32)]),e("div",ft,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[10]||(t[10]=l=>w.value=!1)},"Cancel"),e("button",{type:"button",class:"btn btn-primary",onClick:me,disabled:!E.value},"Import",8,gt)])])])])):x("",!0)]))]))}},kt=le(ht,[["__scopeId","data-v-1d7b89f4"]]),$t={class:"card shadow-sm"},_t={class:"card-header d-flex justify-content-between align-items-center"},Mt={class:"card-body"},Tt={key:0,class:"text-center py-5"},wt={key:1,class:"table-responsive"},xt={class:"table table-hover"},Ct={key:0},Dt=["onKeyup"],Rt={class:"text-end"},Ut={key:0,class:"btn-group btn-group-sm"},At=["onClick"],Et=["onClick"],Ft={key:1,class:"btn-group btn-group-sm"},Vt=["onClick"],St={key:2,class:"text-center py-5 text-muted"},Nt={key:0,class:"modal d-block",tabindex:"-1",style:{background:"rgba(0,0,0,0.5)"}},It={class:"modal-dialog"},Lt={class:"modal-content"},qt={class:"modal-body"},Bt={class:"mb-3"},Kt={class:"modal-footer"},Pt=["disabled"],jt={key:0,class:"spinner-border spinner-border-sm me-2"},Ht={__name:"DepartmentManager",props:{departments:{type:Array,default:()=>[]}},emits:["refresh"],setup(g,{emit:I}){const b=g,T=I,C=J(),y=ee(),$=f(!1),a=f([]),o=f(!1),p=f(""),c=f(null),u=f({title:""}),k=f(!1),w=async()=>{$.value=!0;try{const v=await C.getDepartments();a.value=v.data||v}catch(v){console.error("Failed to load departments:",v),y.error("Failed to load departments")}finally{$.value=!1}},S=async()=>{var v,r;if(p.value.trim()){k.value=!0;try{await C.addDepartment(p.value.trim()),y.success("Department added successfully"),d(),w(),T("refresh")}catch(h){const R=((r=(v=h.response)==null?void 0:v.data)==null?void 0:r.message)||"Failed to add department";y.error(R)}finally{k.value=!1}}},E=(v,r)=>{c.value=v,u.value.title=r},F=()=>{c.value=null,u.value.title=""},_=async v=>{var r,h;if(!u.value.title.trim()||u.value.title===v){F();return}try{await C.updateDepartment(v,u.value.title.trim()),y.success("Department updated successfully"),F(),w(),T("refresh")}catch(R){const U=((h=(r=R.response)==null?void 0:r.data)==null?void 0:h.message)||"Failed to update department";y.error(U)}},s=async v=>{var r,h;if(confirm(`Are you sure you want to delete the "${v}" department?`))try{await C.deleteDepartment(v),y.success("Department deleted successfully"),w(),T("refresh")}catch(R){const U=((h=(r=R.response)==null?void 0:r.data)==null?void 0:h.message)||"Failed to delete department. It may have users assigned to it.";y.error(U)}},d=()=>{o.value=!1,p.value=""};return Z(()=>{b.departments.length>0?a.value=[...b.departments]:w()}),(v,r)=>(n(),i("div",$t,[e("div",_t,[r[4]||(r[4]=e("h5",{class:"mb-0"},"Departments",-1)),e("button",{class:"btn btn-sm btn-primary",onClick:r[0]||(r[0]=h=>o.value=!0)},[...r[3]||(r[3]=[e("i",{class:"bi bi-plus-circle me-1"},null,-1),M("Add Department ",-1)])])]),e("div",Mt,[$.value?(n(),i("div",Tt,[K(O,{height:"3rem",class:"mb-2"}),K(O,{height:"3rem",class:"mb-2"}),K(O,{height:"3rem",class:"mb-2"})])):a.value.length>0?(n(),i("div",wt,[e("table",xt,[r[9]||(r[9]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"Department Name"),e("th",{class:"text-end"},"Actions")])],-1)),e("tbody",null,[(n(!0),i(j,null,H(a.value,(h,R)=>(n(),i("tr",{key:h.title},[e("td",null,[c.value!==R?(n(),i("span",Ct,A(h.title),1)):D((n(),i("input",{key:1,"onUpdate:modelValue":r[1]||(r[1]=U=>u.value.title=U),type:"text",class:"form-control form-control-sm",onKeyup:[ae(U=>_(h.title),["enter"]),ae(F,["esc"])]},null,40,Dt)),[[G,u.value.title]])]),e("td",Rt,[c.value!==R?(n(),i("div",Ut,[e("button",{class:"btn btn-outline-primary",onClick:U=>E(R,h.title),title:"Edit"},[...r[5]||(r[5]=[e("i",{class:"bi bi-pencil"},null,-1)])],8,At),e("button",{class:"btn btn-outline-danger",onClick:U=>s(h.title),title:"Delete"},[...r[6]||(r[6]=[e("i",{class:"bi bi-trash"},null,-1)])],8,Et)])):(n(),i("div",Ft,[e("button",{class:"btn btn-success",onClick:U=>_(h.title),title:"Save"},[...r[7]||(r[7]=[e("i",{class:"bi bi-check"},null,-1)])],8,Vt),e("button",{class:"btn btn-secondary",onClick:F,title:"Cancel"},[...r[8]||(r[8]=[e("i",{class:"bi bi-x"},null,-1)])])]))])]))),128))])])])):(n(),i("div",St,[...r[10]||(r[10]=[e("i",{class:"bi bi-building display-4 mb-3 d-block"},null,-1),e("p",null,"No departments found",-1)])]))]),(n(),z(Y,{to:"body"},[o.value?(n(),i("div",Nt,[e("div",It,[e("div",Lt,[e("div",{class:"modal-header"},[r[11]||(r[11]=e("h5",{class:"modal-title"},"Add Department",-1)),e("button",{type:"button",class:"btn-close",onClick:d})]),e("form",{onSubmit:B(S,["prevent"])},[e("div",qt,[e("div",Bt,[r[12]||(r[12]=e("label",{class:"form-label"},[M("Department Name "),e("span",{class:"text-danger"},"*")],-1)),D(e("input",{"onUpdate:modelValue":r[2]||(r[2]=h=>p.value=h),type:"text",class:"form-control",placeholder:"Max. 50 characters",maxlength:"50",required:""},null,512),[[G,p.value]])])]),e("div",Kt,[e("button",{type:"button",class:"btn btn-secondary",onClick:d},"Cancel"),e("button",{type:"submit",class:"btn btn-primary",disabled:!p.value.trim()||k.value},[k.value?(n(),i("span",jt)):x("",!0),r[13]||(r[13]=M(" Add ",-1))],8,Pt)])],32)])])])):x("",!0)]))]))}},Ot={class:"container-fluid py-4"},zt={class:"nav nav-tabs mb-4"},Gt={class:"nav-item"},Jt={key:0,class:"nav-item"},Qt={__name:"TeamManagementDashboard",props:{userRole:{type:Number,required:!0}},setup(g){const I=g,b=f("members"),T=f([]),C=J(),y=q(()=>[1,2].includes(I.userRole)),$=async()=>{if(!y.value){T.value=[];return}try{const a=await C.getDepartments(),o=a.data||a;T.value=o.map(p=>({title:p.title}))}catch(a){console.error("Failed to load departments:",a),T.value=[]}};return W(y,a=>{!a&&b.value==="departments"&&(b.value="members")}),Z(()=>{$()}),(a,o)=>(n(),i("div",Ot,[o[4]||(o[4]=e("h1",{class:"h3 mb-4"},"Team Management",-1)),e("ul",zt,[e("li",Gt,[e("a",{class:V(["nav-link",{active:b.value==="members"}]),href:"#",onClick:o[0]||(o[0]=B(p=>b.value="members",["prevent"]))},[...o[2]||(o[2]=[e("i",{class:"bi bi-people me-2"},null,-1),M("Team Members ",-1)])],2)]),y.value?(n(),i("li",Jt,[e("a",{class:V(["nav-link",{active:b.value==="departments"}]),href:"#",onClick:o[1]||(o[1]=B(p=>b.value="departments",["prevent"]))},[...o[3]||(o[3]=[e("i",{class:"bi bi-building me-2"},null,-1),M("Departments ",-1)])],2)])):x("",!0)]),K(pe,{name:"fade",mode:"out-in"},{default:ce(()=>[b.value==="members"?(n(),z(kt,{key:"members","user-role":g.userRole,departments:T.value,"can-manage-departments":y.value,onRefreshDepartments:$},null,8,["user-role","departments","can-manage-departments"])):y.value?(n(),z(Ht,{key:"departments",departments:T.value,onRefresh:$},null,8,["departments"])):x("",!0)]),_:1})]))}},es=le(Qt,[["__scopeId","data-v-7db094cf"]]);export{es as default};
